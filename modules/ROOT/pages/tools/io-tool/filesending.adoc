:imagesdir: 
= File Exchange

== Sending Files

You can choose to publish or to send the files to one or multiple endpoints. Publishing means you send them out and anyone who is interested ("subscribed") will receive a copy. More information about the concept of publishing and subscribing can be found in the section  https://docs.agrirouter.com/agrirouter-interface-documentation/latest/message-exchange.html#sending-messages-to-machines[Concept of Message Exchange]. Yet when you send the files, you select a specific recipient. 


To send files via agrirouter you need to upload them to your _Data Storage_ (drag and drop, or click to choose).

image::io-tool/uploadbutton.png[]

You will be shown a popup after successful upload.

image::io-tool/multifieldsupload.png[]

This is a pop up message you receive when uploading a valid data (Validation only applies to telemetry data).

When sending files, you can select all from your _Data Storage_. To send files from the Data Storage view you need to select them with the tick scroll to the buttom and use the buttons _Send to endpoint_ or _Publish_:

image::io-tool/sendingfromstorage.png[]

Afterwards, you have to select one or multiple endpoints and simply click Send.

image::io-tool/sendtoendpoint.png[]


You will receive the following pop-up message in the top right corner when your message has been successfully sent. (You can also check this in the logs).

image::io-tool/sentsuccess.png[]

See the xref:tools/io-tool/troubleshooting.adoc[Troubleshooting] section for some common error scenarios when uploading, sending or receiving files.

Alternatively, to send files from the *Endpoints* section, you must select an endpoint to use the Send feature, or publish without selecting an endpoint. Once you have selected your preferred endpoint from the list, the Send button becomes active.

image::io-tool/sendorpublish.png[]

After clicking one of the buttons, a new window will appear with the files from your Data Storage. Here you can select one or more files and simply click Send.

image::io-tool/sending.png[]


== Receiving Files

The IO-Tool receives all files that are directly addressed to it or for which it is subscribed (xref:tools/io-tool/onoffboarding.adoc[Onboarding & Offboarding]) in its agrirouter feed.
If push notifications are active, the file is automatically delivered to the IO-Tool. Otherwise, or in case of problems with agrirouter during sending, the messages will be requested from the feed via the Receive All or Receive from today buttons.

Whenever a file is received, a message is displayed in the logs.

image::io-tool/receive.png[]


The Clear feed button is particularly useful if you have sent a broken dataset to the IO-Tool (imagine a farming software developer sending a Zip file in a broken format so that the IO-Tool cannot load it. To avoid future errors, it's better to delete the feed). Note that this button deletes all messages from the feed in agrirouter for that specific endpoint and there's no additional popup to warn the user.

In this view, you can edit (name and type), delete, download, publish or send the received files.

image::io-tool/storageeditfiles.png[]

Use the pen symbol to rename the file and organise your data storage. You can change the type by clicking on it and selecting another one from the list. 
The bin symbol deletes the file, the cloud symbol downloads it.


You can also view EFDI and GPS:Info data using the map symbol, that is displayed under the column Actions for this type of files.

image::io-tool/efdiview.png[]

